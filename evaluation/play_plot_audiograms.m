#!/usr/bin/octave
close all
clear
clc

addpath 'features/hzappp-full'

mkdir('figures');

individualizations = {'A', 'AG', 'AD'};

ids = {... sorted according to performance in quiet
  'listener10-l' ...
  'listener03-l' ...
  'listener16-l' ...
  'listener09-l' ...
  'listener17-r' ...
  'listener01-l' ...
  'listener18-r' ...
  'listener20-l' ...
  'listener07-l' ...
  'listener15-r' ...
  'listener08-l' ...
  'listener19-r' ...
  'listener14-r' ...
  'listener05-l' ...
  'listener06-r' ...
  'listener21-l' ...
  'listener12-l' ...
  'listener02-r' ...
};

%ids = {...
%  'listener01-l' ...
%  'listener03-l' ...
%  'listener06-r' ...
%  'listener07-l' ...
%  'listener09-l' ...
%  'listener10-l' ...
%  'listener16-l' ...
%  'listener17-r' ...
%  'listener18-r' ...
%  'listener19-r' ...
%  'listener20-l' ...
%};

h=2.5;
w=2.5;
colors = jet(length(ids)).*0.8;

for i=1:length(individualizations)
  figure('Position',[0 0 h*100 w*100]);
  [f, ht_norm, ul_norm] = load_hearingstatus('normal', individualizations{i});
  set(gcf,'PaperUnits','inches','PaperPosition',1.4.*[0 0 h w]);
  plot(log([100 10000]),[0 0],'k');
  hold on;
  for j=1:length(ids)
    [f, ht, ul] = load_hearingstatus(ids{j},individualizations{i});
    plot(log(f), ht-ht_norm, '-', 'LineWidth', 1.25, 'Color', colors(j,:));
    %text(log(f(end)),hl(end),ids{i},'HorizontalAlignment','right');
  end
  xlim(log([100 10000]));
  ylim([-10 110]);
  set(gca,'XTick',log([125 250 500 1000 1500 2000 3000 4000 6000 8000]))
  set(gca,'YTick',-10:10:110);
  axis ij;
  grid on;
  set(gca,'XTickLabel',{'0.125' '0.25' '0.5' '1.0' '1.5' '2' '3' '4' '6' '8'});
  xlabel('Frequency / kHz');
  ylabel('Hearing loss / dB');
  title(sprintf('Audiograms %s',individualizations{i}));
  print('-depsc2','-r600',sprintf('figures/audiograms-%s.eps',individualizations{i}));
end
